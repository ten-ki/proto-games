# NITA Games (proto-games)

軽量なブラウザ向けマルチゲームプロトタイプです。サーバーは `Node.js` と `Express`、リアルタイムは `socket.io` を使っています。現在は UNO / Blackjack / Override（簡易ルール）をサポートしています。

**主な特徴**
- リアルタイム対戦（Socket.IO）
- ランダムマッチ（掛け金単位でキュー分け）とロビーの手動入室
- UID による簡易プレイヤー識別（localStorage に UID を保存して前回の所持金/名前を引き継げます）
- UNO の「複数枚同時出し（選択順）」に対応（クライアントで順序を決め、サーバーでその順序どおり処理）
- グローバルチャットと接続時のチャット履歴配信

**素早いセットアップ（ローカル実行）**
1. 依存をインストール

```bash
npm install
```

2. サーバー起動

```bash
npm start
# または
node server.js
```

3. ブラウザで開く

http://localhost:3000

**主要ファイル**
- [server.js](server.js) — サーバー本体（Express + Socket.IO、ゲームロジック、マッチメイキング、UID 管理）
- [public/index.html](public/index.html) — シングルファイルのクライアント UI（ログイン／ロビー／UNO/BJ UI）
- `package.json` — スタートスクリプトと依存定義

**動作上の注意・既知の制約**
- 現在のユーザー保存はサーバーのメモリ内（`usersByUid` / `userDB`）。サーバーを再起動すると消えます。永続化が必要な場合は SQLite/Postgres 等を導入してください。
 - 永続化: 既に簡易ファイル永続化を追加しました。サーバーは `data/` フォルダに `globalChat.json` と `users.json` を保存します。グローバルチャットは24時間分保持されます（`data/globalChat.json` に保存）。
	- 注意: 現在の実装はファイルベースの簡易永続化です。本番運用では DB（SQLite/Postgres）への移行を推奨します。
- クライアント側で UID を localStorage に保存する仕組みがありますが、ブラウザのローカルデータを消すと別ユーザー扱いになります。
- ランダムマッチ時の買い手不足や接続断などの競合は最小限に配慮していますが、より堅牢な対処（トランザクション／DB ロック）は未実装です。

**開発・拡張アイデア**
- 永続化（DB）とログイン連携（OAuth）
- マッチメイキング改善（レーティング、同レベルでのマッチング）
- UNO のドラッグで並び替え UI（ドラッグ＆ドロップによる順序変更）
- 見た目の改善（カードアニメ、レスポンシブ改善）

**貢献**
1. フォークしてブランチを作成
2. 変更をコミットして PR を送る

---
簡単に動くプロトタイプとしてまとめました。README の文言や追記してほしい項目（例：デプロイ手順、環境変数の説明、スクリーンショットなど）があれば教えてください。